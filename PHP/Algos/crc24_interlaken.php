<?php
//CRC-24 INTERLAKEN
//Author: domasz
//Version: 0.1 (2022-11-19)
//Licence: MIT

require_once 'HasherBase.php';

class HasherCRC24_INTERLAKEN extends HasherBase
{
	protected $FHash = 0;

    protected $Table = array(
	0x00000000, 0x00328B63, 0x006516C6, 0x00579DA5, 0x00CA2D8C, 0x00F8A6EF, 0x00AF3B4A, 0x009DB029, 
	0x00A6D07B, 0x00945B18, 0x00C3C6BD, 0x00F14DDE, 0x006CFDF7, 0x005E7694, 0x0009EB31, 0x003B6052, 
	0x007F2B95, 0x004DA0F6, 0x001A3D53, 0x0028B630, 0x00B50619, 0x00878D7A, 0x00D010DF, 0x00E29BBC, 
	0x00D9FBEE, 0x00EB708D, 0x00BCED28, 0x008E664B, 0x0013D662, 0x00215D01, 0x0076C0A4, 0x00444BC7, 
	0x00FE572A, 0x00CCDC49, 0x009B41EC, 0x00A9CA8F, 0x00347AA6, 0x0006F1C5, 0x00516C60, 0x0063E703, 
	0x00588751, 0x006A0C32, 0x003D9197, 0x000F1AF4, 0x0092AADD, 0x00A021BE, 0x00F7BC1B, 0x00C53778, 
	0x00817CBF, 0x00B3F7DC, 0x00E46A79, 0x00D6E11A, 0x004B5133, 0x0079DA50, 0x002E47F5, 0x001CCC96, 
	0x0027ACC4, 0x001527A7, 0x0042BA02, 0x00703161, 0x00ED8148, 0x00DF0A2B, 0x0088978E, 0x00BA1CED, 
	0x00CE2537, 0x00FCAE54, 0x00AB33F1, 0x0099B892, 0x000408BB, 0x003683D8, 0x00611E7D, 0x0053951E, 
	0x0068F54C, 0x005A7E2F, 0x000DE38A, 0x003F68E9, 0x00A2D8C0, 0x009053A3, 0x00C7CE06, 0x00F54565, 
	0x00B10EA2, 0x008385C1, 0x00D41864, 0x00E69307, 0x007B232E, 0x0049A84D, 0x001E35E8, 0x002CBE8B, 
	0x0017DED9, 0x002555BA, 0x0072C81F, 0x0040437C, 0x00DDF355, 0x00EF7836, 0x00B8E593, 0x008A6EF0, 
	0x0030721D, 0x0002F97E, 0x005564DB, 0x0067EFB8, 0x00FA5F91, 0x00C8D4F2, 0x009F4957, 0x00ADC234, 
	0x0096A266, 0x00A42905, 0x00F3B4A0, 0x00C13FC3, 0x005C8FEA, 0x006E0489, 0x0039992C, 0x000B124F, 
	0x004F5988, 0x007DD2EB, 0x002A4F4E, 0x0018C42D, 0x00857404, 0x00B7FF67, 0x00E062C2, 0x00D2E9A1, 
	0x00E989F3, 0x00DB0290, 0x008C9F35, 0x00BE1456, 0x0023A47F, 0x00112F1C, 0x0046B2B9, 0x007439DA, 
	0x00AEC10D, 0x009C4A6E, 0x00CBD7CB, 0x00F95CA8, 0x0064EC81, 0x005667E2, 0x0001FA47, 0x00337124, 
	0x00081176, 0x003A9A15, 0x006D07B0, 0x005F8CD3, 0x00C23CFA, 0x00F0B799, 0x00A72A3C, 0x0095A15F, 
	0x00D1EA98, 0x00E361FB, 0x00B4FC5E, 0x0086773D, 0x001BC714, 0x00294C77, 0x007ED1D2, 0x004C5AB1, 
	0x00773AE3, 0x0045B180, 0x00122C25, 0x0020A746, 0x00BD176F, 0x008F9C0C, 0x00D801A9, 0x00EA8ACA, 
	0x00509627, 0x00621D44, 0x003580E1, 0x00070B82, 0x009ABBAB, 0x00A830C8, 0x00FFAD6D, 0x00CD260E, 
	0x00F6465C, 0x00C4CD3F, 0x0093509A, 0x00A1DBF9, 0x003C6BD0, 0x000EE0B3, 0x00597D16, 0x006BF675, 
	0x002FBDB2, 0x001D36D1, 0x004AAB74, 0x00782017, 0x00E5903E, 0x00D71B5D, 0x008086F8, 0x00B20D9B, 
	0x00896DC9, 0x00BBE6AA, 0x00EC7B0F, 0x00DEF06C, 0x00434045, 0x0071CB26, 0x00265683, 0x0014DDE0, 
	0x0060E43A, 0x00526F59, 0x0005F2FC, 0x0037799F, 0x00AAC9B6, 0x009842D5, 0x00CFDF70, 0x00FD5413, 
	0x00C63441, 0x00F4BF22, 0x00A32287, 0x0091A9E4, 0x000C19CD, 0x003E92AE, 0x00690F0B, 0x005B8468, 
	0x001FCFAF, 0x002D44CC, 0x007AD969, 0x0048520A, 0x00D5E223, 0x00E76940, 0x00B0F4E5, 0x00827F86, 
	0x00B91FD4, 0x008B94B7, 0x00DC0912, 0x00EE8271, 0x00733258, 0x0041B93B, 0x0016249E, 0x0024AFFD, 
	0x009EB310, 0x00AC3873, 0x00FBA5D6, 0x00C92EB5, 0x00549E9C, 0x006615FF, 0x0031885A, 0x00030339, 
	0x0038636B, 0x000AE808, 0x005D75AD, 0x006FFECE, 0x00F24EE7, 0x00C0C584, 0x00975821, 0x00A5D342, 
	0x00E19885, 0x00D313E6, 0x00848E43, 0x00B60520, 0x002BB509, 0x00193E6A, 0x004EA3CF, 0x007C28AC, 
	0x004748FE, 0x0075C39D, 0x00225E38, 0x0010D55B, 0x008D6572, 0x00BFEE11, 0x00E873B4, 0x00DAF8D7
	);


	public function __construct() 
	{
		$this->FHash =  0xFFFFFF;
		$this->Check = 'B4F3E6';
	}

	public function Update($Msg, $Length)
	{
		for ($i=0; $i<$Length; $i++)
		{
			$Index = (ord($Msg[$i]) ^ ($this->FHash >> 16)) & 0xFF;
			$this->FHash = ($this->FHash << 8) ^ $this->Table[$Index];
		}
	}

	public function Finish()
	{
		$this->FHash = $this->FHash & 0xFFFFFF;
		$this->FHash = $this->FHash ^ 0xFFFFFF;
  
		return sprintf('%04X', $this->FHash);
	}
}

$HasherList->RegisterHasher('CRC-24 INTERLAKEN', 'HasherCRC24_INTERLAKEN');